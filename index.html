<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Supabase JS SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.42.3/+esm"></script>
</head>

<body class="bg-gray-100 text-gray-800 font-sans">
  <div class="min-h-screen flex">
    <!-- Sidebar -->
    <aside class="w-64 bg-white shadow-md">
      <div class="p-6 font-bold text-xl text-indigo-600">🛠 Admin Panel</div>
      <nav class="flex flex-col px-4 space-y-4">
        <a href="#" class="text-gray-700 hover:text-indigo-600">📊 Dashboard</a>
        <a href="#" class="text-gray-700 hover:text-indigo-600">👥 Customers</a>
        <a href="#" class="text-gray-700 hover:text-indigo-600">📦 Orders</a>
        <a href="#" class="text-indigo-600 font-semibold">🛍 Products</a>
        <a href="#" class="text-gray-700 hover:text-indigo-600">📈 Analytics</a>
        <a href="#" class="text-red-600 hover:text-red-800">🚪 Logout</a>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-8">
      <h1 class="text-2xl font-bold mb-6">📦 Product List from Supabase</h1>

      <div id="product-list" class="space-y-4">
        <p class="text-gray-500">Loading products...</p>
      </div>
    </main>
  </div>

  <!-- Supabase JS Integration -->
  <script type="module">
    // ✅ Step 1: Set up Supabase
    const SUPABASE_URL = 'https://tkybnsyqxkhemuxohnqs.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRreWJuc3lxeGtoZW11eG9obnFzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2NDU3MjIsImV4cCI6MjA2ODIyMTcyMn0.UeiYJQto84QVLdszbiXR_S27LDOISFSyuHWRpiufV0k';

    const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

    // ✅ Step 2: Fetch products
    async function loadProducts() {
      const list = document.getElementById('product-list');
      list.innerHTML = "<p class='text-gray-500'>Fetching from Supabase...</p>";

      const { data, error } = await supabase.from('products').select('*');

      if (error) {
        list.innerHTML = `<p class="text-red-500">Error: ${error.message}</p>`;
        return;
      }

      if (data.length === 0) {
        list.innerHTML = `<p class="text-yellow-500">No products found.</p>`;
        return;
      }

      list.innerHTML = ''; // Clear loading
      data.forEach((product) => {
        const item = document.createElement('div');
        item.className = 'bg-white p-4 rounded shadow';
        item.innerHTML = `
          <h2 class="text-xl font-semibold">${product.name}</h2>
          <p>💰 Price: ₹${product.price}</p>
          <p>📦 Stock: ${product.stock}</p>
        `;
        list.appendChild(item);
      });
    }

    loadProducts();
  </script>
</body>
</html>
